<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Sopa de letras â€“ ToxicologÃ­a Ambiental</title>

<style>
body{
  margin:0;
  font-family:Arial, Helvetica, sans-serif;
  background:#0b1220;
  color:white;
}

header{
  padding:15px;
  display:flex;
  justify-content:space-between;
  align-items:center;
  background:#111a2e;
}

button{
  padding:8px 14px;
  border-radius:8px;
  border:none;
  cursor:pointer;
}

.container{
  display:flex;
  gap:20px;
  padding:20px;
  flex-wrap:wrap;
}

.grid{
  display:grid;
  grid-template-columns: repeat(16, 35px);
  gap:5px;
}

.cell{
  width:35px;
  height:35px;
  display:flex;
  align-items:center;
  justify-content:center;
  background:#1a2744;
  border-radius:6px;
  cursor:pointer;
  font-weight:bold;
}

.cell.selected{
  background:#3b82f6;
}

.cell.found{
  background:#22c55e;
}

.side{
  max-width:350px;
}

.progressBar{
  height:10px;
  background:#1e293b;
  border-radius:10px;
  overflow:hidden;
}

.progressBar div{
  height:100%;
  background:#22c55e;
  width:0%;
}

.hostPanel{
  display:none;
  padding:15px;
  background:#111a2e;
}

table{
  width:100%;
  border-collapse:collapse;
}

td,th{
  border-bottom:1px solid #334155;
  padding:6px;
  text-align:center;
}

/* MODAL */
.modalBack{
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.85);
  display:flex;
  justify-content:center;
  align-items:center;
}

.modal{
  background:#111a2e;
  padding:30px;
  border-radius:12px;
  width:320px;
}

.modal input{
  width:100%;
  padding:8px;
  margin-bottom:10px;
  border-radius:6px;
  border:none;
}
</style>
</head>
<body>

<header>
<h2>Sopa de letras â€“ ToxicologÃ­a Ambiental</h2>
<button onclick="newGame()">Nuevo juego</button>
</header>

<div class="hostPanel" id="hostPanel">
<h3>Organizador â€“ Avance en vivo</h3>
<table>
<thead>
<tr>
<th>Pos</th>
<th>Nombre</th>
<th>Carrera</th>
<th>Encontradas</th>
<th>%</th>
</tr>
</thead>
<tbody id="rankingBody"></tbody>
</table>
</div>

<div class="container">
<div>
<div class="grid" id="grid"></div>
</div>

<div class="side">
<h3 id="playerInfo"></h3>

<p>Progreso</p>
<div class="progressBar"><div id="bar"></div></div>
<p id="scoreText"></p>

<h3>Preguntas</h3>
<ol id="questions"></ol>
</div>
</div>

<div class="modalBack" id="modal">
<div class="modal">
<h3>Antes de iniciar</h3>
<input type="text" id="nameInput" placeholder="Nombre" required>
<input type="text" id="careerInput" placeholder="Carrera" required>
<button onclick="startGame()">Iniciar</button>
</div>
</div>

<script>

const QA = [
{q:"Sustancia que produce daÃ±o.",a:"AGENTETOXICO"},
{q:"Capacidad de causar daÃ±o.",a:"TOXICIDAD"},
{q:"Cantidad que ingresa al cuerpo.",a:"DOSIS"},
{q:"Contacto con sustancia.",a:"EXPOSICION"},
{q:"ExposiciÃ³n corta.",a:"AGUDA"},
{q:"ExposiciÃ³n prolongada.",a:"CRONICA"},
{q:"Origen de contaminantes.",a:"FUENTES"},
{q:"TÃ³xicos fÃ­sicos.",a:"FISICOS"},
{q:"TÃ³xicos quÃ­micos.",a:"QUIMICOS"},
{q:"TÃ³xicos biolÃ³gicos.",a:"BIOLOGICOS"},
{q:"DaÃ±o por metales pesados.",a:"NEUROTOXICIDAD"},
{q:"Sustancias que afectan hÃ­gado.",a:"HEPATOTOXICOS"},
{q:"Sustancias cancerÃ­genas.",a:"CARCINOGENOS"},
{q:"Estudio de venenos.",a:"TOXICOLOGIA"},
{q:"Efecto acumulativo.",a:"BIOACUMULACION"}
];

let gridSize=16;
let grid=[];
let selected=[];
let foundCount=0;
let player={name:"",career:""};
let isHost=window.location.search.includes("host=1");

if(isHost) document.getElementById("hostPanel").style.display="block";

function startGame(){
let name=document.getElementById("nameInput").value;
let career=document.getElementById("careerInput").value;
if(!name||!career){alert("Completa los datos");return;}
player.name=name;
player.career=career;
document.getElementById("modal").style.display="none";
document.getElementById("playerInfo").innerText="ðŸ‘¤ "+name+" | ðŸŽ“ "+career;
newGame();
}

function newGame(){
foundCount=0;
grid=Array.from({length:gridSize},()=>Array(gridSize).fill(""));
let letters="ABCDEFGHIJKLMNOPQRSTUVWXYZ";
for(let r=0;r<gridSize;r++){
for(let c=0;c<gridSize;c++){
grid[r][c]=letters[Math.floor(Math.random()*letters.length)];
}}
placeWords();
render();
updateProgress();
renderQuestions();
}

function placeWords(){
QA.forEach(item=>{
let word=item.a;
let row=Math.floor(Math.random()*gridSize);
let col=Math.floor(Math.random()*(gridSize-word.length));
for(let i=0;i<word.length;i++){
grid[row][col+i]=word[i];
}
});
}

function render(){
let gridDiv=document.getElementById("grid");
gridDiv.innerHTML="";
grid.forEach((row,r)=>{
row.forEach((cell,c)=>{
let div=document.createElement("div");
div.className="cell";
div.innerText=cell;
div.onclick=()=>selectCell(div);
gridDiv.appendChild(div);
});
});
}

function selectCell(div){
div.classList.toggle("selected");
}

function renderQuestions(){
let qList=document.getElementById("questions");
qList.innerHTML="";
QA.forEach(q=>{
let li=document.createElement("li");
li.innerText=q.q;
qList.appendChild(li);
});
}

function updateProgress(){
let percent=Math.round((foundCount/QA.length)*100);
document.getElementById("bar").style.width=percent+"%";
document.getElementById("scoreText").innerText="Encontradas: "+foundCount+" / "+QA.length;
saveRanking();
}

function saveRanking(){
let ranking=JSON.parse(localStorage.getItem("ranking")||"[]");
let existing=ranking.find(r=>r.name===player.name);
if(existing){
existing.score=foundCount;
}else{
ranking.push({name:player.name,career:player.career,score:foundCount});
}
ranking.sort((a,b)=>b.score-a.score);
localStorage.setItem("ranking",JSON.stringify(ranking));
renderRanking();
}

function renderRanking(){
if(!isHost) return;
let ranking=JSON.parse(localStorage.getItem("ranking")||"[]");
let body=document.getElementById("rankingBody");
body.innerHTML="";
ranking.forEach((r,i)=>{
let row="<tr><td>"+(i+1)+"</td><td>"+r.name+"</td><td>"+r.career+"</td><td>"+r.score+"</td><td>"+Math.round((r.score/QA.length)*100)+"%</td></tr>";
body.innerHTML+=row;
});
}

renderRanking();

</script>

</body>
</html>:
